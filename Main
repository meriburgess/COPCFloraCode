#include <Adafruit_NeoPixel.h> 

#ifdef __AVR__
  #include <avr/power.h>
#endif

#define PIN 6
#define NUMPIXELS 20

Adafruit_NeoPixel pixels = Adafruit_NeoPixel(20, PIN, NEO_GRB + NEO_KHZ800);

void setup() {
  pixels.begin();
  pixels.show();

}

void loop() {
  delay(8050);
  
  
  int rightSide[] = {18, 19, 0, 1, 2, 3, 4, 6};
  int leftSide[] = {16, 15, 14, 13, 12, 11, 10, 7};
  int chest[] = {0, 19, 18, 17, 16, 15, 14, 13};
  int hips[] = {4, 5, 6, 7, 8, 9, 10, 11};
  //intro slow
  runThroughEight(pixels.Color(127,127,200), 325, leftSide);
  runThroughEight(pixels.Color(127,127,200), 320, rightSide);
  runThroughEight(pixels.Color(127,127,200), 325, leftSide);
  runThroughEight(pixels.Color(127,127,200), 330, rightSide);

  //explodes, with small pulses between
  explode(pixels.Color(127,127,200), 750);
  delay(1100);

  explode(pixels.Color(127,127,200), 200);
  delay(150);
  explode(pixels.Color(127,127,200), 200);
  delay(1050);
  
  explode(pixels.Color(127,127,200), 750);
  delay(1050);

  explode(pixels.Color(127,127,200), 200);
  delay(150);
  explode(pixels.Color(127,127,200), 200);
  delay(600);
  
  explode(pixels.Color(127,127,200), 750);
  delay(1000);

  explode(pixels.Color(127,127,200), 200);
  delay(150);
  explode(pixels.Color(127,127,200), 200);
  delay(550);
  
  explode(pixels.Color(127,127,200), 750);
  delay(750);

  //0:36 chicka chicka chick-ah!
  int chickaRun1[] = {5, 6, 7, 8, 9, 10, 4, 3};
  int chickaRun2[] = {11, 12, 2, 0, 1, 13, 14, 15};
  int chickaRun3[] = {0, 16, 17, 19, 0, 17, 19, 18};

  runThroughEight(pixels.Color(127,127,200), 40, chickaRun1);
  runThroughEight(pixels.Color(127,127,200), 40, chickaRun2);
  runThroughEight(pixels.Color(127,127,200), 30, chickaRun3);

  // On until 0:50 
  explode(pixels.Color(127,127,200), 1650);  

  ongoing(pixels.Color(127,127,200), 500);
  ongoing(pixels.Color(127,127,200), 500);
  ongoing(pixels.Color(127,127,200), 350);
  ongoing(pixels.Color(127,127,200), 350);

  explode(pixels.Color(127,127,200), 1000);
  
  runThroughEight(pixels.Color(127,127,200), 220, chest);
  runThroughEight(pixels.Color(127,127,200), 250, hips);
  
  explode(pixels.Color(127,127,200), 1000);
  ongoing(pixels.Color(127,127,200), 500);
  ongoing(pixels.Color(127,127,200), 500);
  explode(pixels.Color(127,127,200), 500);
  
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun1);
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun2);
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun3);
  
  titularLyric(pixels.Color(127,127,200), 150, leftSide, rightSide);
  titularLyric(pixels.Color(127,127,200), 150, leftSide, rightSide);
  
  runThroughEight(pixels.Color(127,127,200), 200, leftSide);
  runThroughEight(pixels.Color(127,127,200), 200, rightSide);
  
  titularLyric(pixels.Color(127,127,200), 100, leftSide, rightSide);
  titularLyric(pixels.Color(127,127,200), 150, leftSide, rightSide);
  runThroughEight(pixels.Color(127,127,200), 100, chest);
  runThroughEight(pixels.Color(127,127,200), 100, hips);
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun1);
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun2);
  runThroughEight(pixels.Color(127,127,200), 100, chickaRun3);
  runThroughEight(pixels.Color(127,127,200), 250, leftSide);
  runThroughEight(pixels.Color(127,127,200), 250, rightSide);
  explode(pixels.Color(127,127,200), 1000);
  delay(500);
  explode(pixels.Color(127,127,200), 1000);
  delay(400);
  explode(pixels.Color(127,127,200), 2000);
  delay(500);
  titularLyric(pixels.Color(127,127,200), 150, leftSide, rightSide);
  delay(2000);
  titularLyric(pixels.Color(127,127,200), 150, leftSide, rightSide);
  delay(1700);
  titularLyric(pixels.Color(127,127,200), 50, leftSide, rightSide);
  
  runThroughEight(pixels.Color(127,127,200), 40, chickaRun1);
  runThroughEight(pixels.Color(127,127,200), 40, chickaRun2);
  runThroughEight(pixels.Color(127,127,200), 30, chickaRun3);
  runThroughEight(pixels.Color(127,127,200), 40, chickaRun1);
  runThroughEight(pixels.Color(127,127,200), 40, chickaRun2);
  runThroughEight(pixels.Color(127,127,200), 30, chickaRun3);
  explode(pixels.Color(127,127,200), 1650);  

  ongoing(pixels.Color(127,127,200), 500);
  ongoing(pixels.Color(127,127,200), 500);
  ongoing(pixels.Color(127,127,200), 350);
  ongoing(pixels.Color(127,127,200), 350);

  explode(pixels.Color(127,127,200), 3000);
  delay(1000);
  titularLyric(pixels.Color(127,127,200), 100, leftSide, rightSide);
  titularLyric(pixels.Color(127,127,200), 100, leftSide, rightSide);
  explode(pixels.Color(127,127,200), 2000);
  delay(500);
  explode(pixels.Color(127,127,200), 2000);
  delay(500);
  explode(pixels.Color(127,127,200), 2000);
  delay(500);
  

  titularLyric(pixels.Color(127,127,200), 200, leftSide, rightSide);
  titularLyric(pixels.Color(127,127,200), 100, leftSide, rightSide);
  runThroughEight(pixels.Color(127,127,200), 100, chest);
  runThroughEight(pixels.Color(127,127,200), 100, hips);
  runThroughEight(pixels.Color(127,127,200), 200, leftSide);
  runThroughEight(pixels.Color(127,127,200), 200, rightSide);
  titularLyric(pixels.Color(127,127,200), 170, leftSide, rightSide);

  titularLyric(pixels.Color(127,127,200), 300, leftSide, rightSide);
  runThroughEight(pixels.Color(127,127,200), 100, chest);
  runThroughEight(pixels.Color(127,127,200), 100, hips);
  runThroughEight(pixels.Color(127,127,200), 200, leftSide);
  runThroughEight(pixels.Color(127,127,200), 200, rightSide);
  delay(500);
  titularLyric(pixels.Color(127,127,200), 300, leftSide, rightSide);
  delay(1000);
  
  runThroughEight(pixels.Color(127,127,200), 25, rightSide);
  runThroughEight(pixels.Color(127,127,200), 25, leftSide);
  runThroughEight(pixels.Color(127,127,200), 25, rightSide);
  runThroughEight(pixels.Color(127,127,200), 25, leftSide);
  explode(pixels.Color(127,127,200), 3000);
  delay(1000);

  runThroughEight(pixels.Color(127,127,200), 25, rightSide);
  runThroughEight(pixels.Color(127,127,200), 25, leftSide);
  runThroughEight(pixels.Color(127,127,200), 25, rightSide);
  runThroughEight(pixels.Color(127,127,200), 25, leftSide);
  explode(pixels.Color(127,127,200), 3000);
  delay(1000);
}

void runThroughEight(uint32_t c, uint32_t wait, int runThru[] )
{
  pixels.setPixelColor(runThru[0], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[1], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[2], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[0], 0);
  pixels.setPixelColor(runThru[3], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[1], 0);
  pixels.setPixelColor(runThru[4], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[2], 0);
  pixels.setPixelColor(runThru[5], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[3], 0);
  pixels.setPixelColor(runThru[6], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[4], 0);
  pixels.setPixelColor(runThru[7], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[5], 0);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[6], 0);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(runThru[7], 0);
  pixels.show(); 
}

void explode(uint32_t c, uint32_t wait)
{
  for(int i = 0; i < NUMPIXELS; i++)
  {
    pixels.setPixelColor(i, c);
  }
  pixels.show();
  delay(wait);
  for(int i = 0; i < NUMPIXELS; i++)
  {
    pixels.setPixelColor(i, 0);
  }
  pixels.show();
 
}

void ongoing(uint32_t c, uint32_t wait)
{
  int group[] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19};

  for(int i = 0; i < NUMPIXELS; i++)
  {
    pixels.setPixelColor(i, 0);
    int r = random(i, 19);
    int temp = group[i];
    group[i] = group[r];
    group[r] = temp; 
  }
  pixels.show();

  pixels.setPixelColor(group[0], c);
  pixels.show();
  delay(wait/2);
  pixels.setPixelColor(group[1], c);
  pixels.show();
  delay(wait/4);
  pixels.setPixelColor(group[2], c);
  pixels.show();
  delay(wait/2);
  pixels.setPixelColor(group[3], c);
  pixels.show();
  delay(wait/4);
  pixels.setPixelColor(group[4], c);
  pixels.show();
  delay(wait/2);
  pixels.setPixelColor(group[5], c);
  pixels.show();
  delay(wait/4);
  pixels.setPixelColor(group[6], c);
  pixels.show();
  delay(wait/2);
  pixels.setPixelColor(group[7], c);
  pixels.show();
  delay(500);
  pixels.setPixelColor(group[8], c);
  pixels.show();
  delay(wait/4);
  pixels.setPixelColor(group[9], c);
  pixels.setPixelColor(group[1], 0);
  pixels.show();
  delay(wait/2);
  pixels.setPixelColor(group[2], 0);
  pixels.show();
  delay(500);
  pixels.setPixelColor(group[0], 0);
  pixels.show();
  delay(wait/4);
 
}

//wandering Staaaar
void titularLyric(uint32_t c, uint32_t wait, int group1[], int group2[])
{
  pixels.setPixelColor(group1[0], c);
   pixels.setPixelColor(group2[0], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[1], c);
   pixels.setPixelColor(group2[1], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[2], c);
   pixels.setPixelColor(group2[2], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[0], 0);
   pixels.setPixelColor(group2[0], 0);
   pixels.setPixelColor(group1[3], c);
  pixels.setPixelColor(group2[3], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[1], 0);
   pixels.setPixelColor(group2[1], 0);
  pixels.setPixelColor(group1[4], c);
   pixels.setPixelColor(group2[4], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[2], 0);
   pixels.setPixelColor(group2[2], 2);
  pixels.setPixelColor(group1[5], c);
   pixels.setPixelColor(group2[5], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[3], 0);
  pixels.setPixelColor(group1[6], c);
  pixels.setPixelColor(group2[3], 0);
  pixels.setPixelColor(group2[6], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[4], 0);
  pixels.setPixelColor(group1[7], c);
  pixels.setPixelColor(group2[4], 0);
  pixels.setPixelColor(group2[7], c);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[5], 0);
  pixels.setPixelColor(group2[5], 0);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[6], 0);
  pixels.setPixelColor(group2[6], 0);
  pixels.show(); 
  delay(wait);
  pixels.setPixelColor(group1[7], 0);
  pixels.setPixelColor(group2[7], 0);
  pixels.show(); 
}
